# app/exercises.py
# ТЕМЫ И УПРАЖНЕНИЯ ДЛЯ ПОМНИ
# Формат:
# TOPICS = {
#   "<topic_id>": {
#       "title": "...",
#       "exercises": [
#           # Вариант A — пошаговое упражнение (степпер):
#           {"id": "...", "title": "...", "steps": ["(0) Инструкция...", "1) ...", "2) ...", ...]},
#           # Вариант B — текстовое упражнение (без степпера):
#           {"id": "...", "title": "...", "text": "описание + инструкция"}
#       ]
#   }, ...
# }
#
# Правила:
# - Для пошаговых упражнений первый элемент steps — это короткая ИНСТРУКЦИЯ
#   (что это, зачем, как действовать). Пользователь нажимает "Далее" после
#   выполнения шага; текст отвечать НЕ обязательно (можно, если хочется).
# - Для текстовых упражнений бот просто показывает текст и клавишу "Назад".
# - Следите за непрерывной нумерацией шагов: 0 (инструкция), 1, 2, 3...
#   Это фиксит кейс "после шага 1 прыгает сразу на 4".

TOPICS = {
    "panic": {
        "title": "Паническая атака",
        "exercises": [
            {
                "id": "panic_relax",
                "title": "Прогрессивная релаксация (3 минуты)",
                "steps": [
                    "ИНСТРУКЦИЯ — 3 минуты. Сядь/ляг, телефон в беззвучный. После каждого микрошага жми «Далее». Если хочешь — можешь коротко отвечать текстом, но это не обязательно.",
                    "1) Плечи: подними к ушам на 5 секунд → отпусти вместе с выдохом.",
                    "2) Кулаки: сожми на 5 сек → расслабь, слегка потряси кистями.",
                    "3) Лицо: наморщи лоб и щеки на 5 сек → отпусти, мягко разомкни челюсть.",
                    "4) Ноги: натяни носки на себя на 5 сек → отпусти, покрути стопами.",
                    "5) Итог: один длинный вдох-выдох и отметь, где стало чуть спокойнее."
                ]
            },
            {
                "id": "panic_plan_short",
                "title": "План при панической атаке (коротко)",
                "steps": [
                    "ИНСТРУКЦИЯ — быстрая карта действий на 2–3 минуты. Просто следуй шагам и жми «Далее».",
                    "1) Замри на месте, обопрись на что-то устойчивое. Скажи себе: «Это паническая атака — она пройдет».",
                    "2) Дыхание 3×3: вдох через нос 3 сек → пауза 3 сек → выдох 3 сек (три цикла).",
                    "3) Заземление 5‑4‑3‑2‑1: назови 5 видимых объектов, 4 тактильных ощущения, 3 звука, 2 запаха, 1 вкус/ощущение во рту.",
                    "4) Напоминание: это безопасно и временно. Это волна — тебе не нужно с ней бороться, просто пережди."
                ]
            }
        ]
    },

    "anxiety": {
        "title": "Тревога",
        "exercises": [
            {
                "id": "anti_cata_mini",
                "title": "Анти‑катастрофизация (КПТ‑мини)",
                "steps": [
                    "ИНСТРУКЦИЯ — мини‑разбор мысли. Можно писать короткие ответы, но не обязательно: жми «Далее» после шага.",
                    "1) Мысль: какая пугающая мысль сейчас крутится в голове? (можешь написать её коротко)",
                    "2) Доказательства «за»: какие факты реально подтверждают эту мысль?",
                    "3) Доказательства «против»: какие факты/опыт её ослабляют?",
                    "4) Альтернативный взгляд: что ещё можно подумать?",
                    "5) Шкала: оцени тревогу от 0 до 10 сейчас. Сравни с началом."
                ]
            },
            {
                "id": "ground_54321",
                "title": "Заземление 5‑4‑3‑2‑1",
                "steps": [
                    "ИНСТРУКЦИЯ — вернуть внимание в настоящее за ~2 минуты. После каждой подсказки жми «Далее».",
                    "1) Посмотри вокруг и назови 5 предметов/форм/цветов.",
                    "2) Ощути 4 тактильных контакта (одежда, поверхность, температура).",
                    "3) Прислушайся к 3 звукам.",
                    "4) Отметь 2 запаха или их отсутствие.",
                    "5) Заметь 1 ощущение во рту/в теле (например, прохлада вдоха)."
                ]
            },
            {
                "id": "box_breath",
                "title": "Квадратное дыхание (1 мин)",
                "steps": [
                    "ИНСТРУКЦИЯ — 1 минута по схеме 4‑4‑4‑4. Следуй шагам, жми «Далее».",
                    "1) Вдох на 4 счёта.",
                    "2) Пауза на 4 счёта.",
                    "3) Выдох на 4 счёта.",
                    "4) Пауза на 4 счёта. Повтори цикл 3–4 раза."
                ]
            }
        ]
    },

    "anger": {
        "title": "Злость",
        "exercises": [
            {
                "id": "dbt_stop",
                "title": "Навык STOP",
                "steps": [
                    "ИНСТРУКЦИЯ — короткая DBT‑пауза. Следуй буквам S‑T‑O‑P и жми «Далее».",
                    "S — Stop: остановись, не действуй сгоряча.",
                    "T — Take a breath: один глубокий вдох‑выдох.",
                    "O — Observe: заметь, что в теле/мыслях/окружении.",
                    "P — Proceed: действуй осознанно, маленьким шагом."
                ]
            },
            {
                "id": "urge_surf",
                "title": "Сёрфинг на импульсе",
                "steps": [
                    "ИНСТРУКЦИЯ — наблюдаем импульс как волну 2–3 минуты. Можно писать короткие замечания, но это необязательно.",
                    "1) Где в теле импульс сильнее всего?",
                    "2) Как меняется волна: растет, падает, пульсирует?",
                    "3) Что поможет «оседлать» волну: дыхание, заземление, пауза?",
                    "4) Заметь момент, когда волна ослабеет хотя бы на 1 пункт из 10."
                ]
            }
        ]
    },

    "sadness": {
        "title": "Боль и тоска",
        "exercises": [
            {
                "id": "self_compassion_note",
                "title": "Записка поддержки себе",
                "text": "Напиши 3–5 предложений так, как бы ты поддержал друга в похожей ситуации. Формула: признать боль → доброжелательность → маленькая забота о себе сегодня. Когда будешь готов — вернись назад к списку."
            },
            {
                "id": "tiny_action",
                "title": "Маленькое действие на 10 минут",
                "text": "Выбери одну крошечную вещь (душ, посуда 5 минут, короткая прогулка, музыка, стакан воды, разминка). Сделай только это и вернись — мы отметим, что получилось."
            }
        ]
    },

    "sleep": {
        "title": "Сон",
        "exercises": [
            {
                "id": "wind_down_20",
                "title": "Выключение дня: 20 минут перед сном",
                "steps": [
                    "ИНСТРУКЦИЯ — ритуал перед сном (~20 мин). Следуй шагам, жми «Далее».",
                    "1) Свет и экраны: приглуши свет, убери телефон на режим «не беспокоить».",
                    "2) Тело: тёплый душ/умывание, расслабляющая растяжка 2–3 минуты.",
                    "3) Голова: выпиши 3 дела на завтра, закрывай «незакрытые гештальты».",
                    "4) Спокойствие: дыхание 4‑7‑8 или короткая медитация лёжа."
                ]
            },
            {
                "id": "breath_478",
                "title": "Дыхание 4‑7‑8",
                "steps": [
                    "ИНСТРУКЦИЯ — 2 минуты. Повтори цикл 4–6 раз; жми «Далее» после каждого.",
                    "1) Вдох через нос на 4 счёта.",
                    "2) Пауза на 7 счётов.",
                    "3) Выдох через рот на 8 счётов."
                ]
            }
        ]
    },

    "meditations": {
        "title": "Медитации",
        "exercises": [
            {
                "id": "one_min_breath",
                "title": "1‑минутная пауза дыхания",
                "steps": [
                    "ИНСТРУКЦИЯ — настройка внимания на 1 минуту.",
                    "1) Почувствуй опору тела и дыхание у входа в нос.",
                    "2) Сделай 6–8 спокойных циклов дыхания, отмечая начало/середину/конец вдоха и выдоха.",
                    "3) Закончить: глубокий вдох‑выдох; мягко открой глаза."
                ]
            },
            {
                "id": "body_scan_short",
                "title": "Сканирование тела (коротко)",
                "steps": [
                    "ИНСТРУКЦИЯ — 3–4 минуты, лёжа/сидя.",
                    "1) Переведи внимание в стопы и икры — 10–15 сек.",
                    "2) Колени и бёдра — 10–15 сек.",
                    "3) Живот и грудь — 10–15 сек.",
                    "4) Плечи, шея, лицо — 10–15 сек.",
                    "5) Целиком всё тело — 10–15 сек."
                ]
            }
        ]
    }
}
